{% extends "base.html" %}

<!-- Macro for toggle button to display _output fields of checks -->
{% macro toggle_output(output, target, title) %}
    <button class="commonstyle own-line btn btn-default btn-sm" data-toggle="collapse" data-target={{'#' + target}}>
        {{title}}
    </button>
    <div class="commonstyle collapse" id={{target}}>
        <pre><code>{{output}}</code></pre>
    </div>
{% endmacro %}

{% block content %}
    <div class="container-fluid">
        <h4>
            <span>{{page_title}}</span>
        </h4>
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr class="row active">
                        <th scope="col">status</th>
                        {% for kwarg in history_kwargs %}
                            <th scope="col">{{kwarg}}</th>
                        {% endfor %}
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    {% for entry in history %}
                        {% set rowstat = '' %}
                        {% if entry[0] in ['PASS', 'DONE'] %}
                            {% set rowstat = 'success' %}
                        {% elif entry[0] in ['WARN', 'PEND'] %}
                            {% set rowstat = 'warning' %}
                        {% elif entry[0] == 'FAIL' %}
                            {% set rowstat = 'danger' %}
                        {% elif entry[0] == 'ERROR' %}
                            {% set rowstat = 'active' %}
                        {% else %}
                            {% set rowstat = '' %}
                        {% endif %}
                        <tr class="{{'row ' + rowstat}}">
                            <td>{{entry[0]}}</td>
                            {% for kw in history_kwargs %}
                                <td>{{entry[1].get(kw)}}</td>
                            {% endfor %}
                            {% if 'uuid' in entry[1] %}
                                <td>
                                    <a target="_blank" href={{"https://" + domain + "/api/load/" + env + "/" + check + "/" + entry[1]['uuid']}}>View</a>
                                </td>
                            {% else %}
                                <td>Error</td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
